
// Every override in here is a candidate for a change made to the original scss file

// NOTE: removed blockquote customization from quire-page.scss

// Create SASS variable for root path because there's no easy way to automate this
// TODO: how to get publication url from publication.yaml to here?
// Can we work with environment variables in SASS/11ty?
$root_path: "/";
//$root_path: "/mayer-2023/"; // Github pages path only

/* Cover page
 * TODO: Title responsiveness
 ************************************************************************/
.quire-cover__hero {
  background: $content-background-color;
  min-height: unset !important; // TODO: fix base styles to get rid of this nonsense

  .quire-cover__overlay {
    background-color: #000;
    background-image: url("#{$root_path}_assets/images/cover-800.jpg");
    background-position: center top;
    background-size: contain;
    height: calc(100vw / 1.539695268644747); // based on image aspect ratio
    min-height: unset;
    position: unset;

    @media screen and (min-width: 48rem) {
      background-image: url("#{$root_path}_assets/images/cover-1400.jpg");
    }
    @media screen and (min-width: 78rem) {
      background-image: url("#{$root_path}_assets/images/cover-1920.jpg");
      height: calc(100vw / 6.185567010309278);
    }
    @media screen and (min-width: 120rem) {
      background-image: url("#{$root_path}_assets/images/cover-3000.jpg");
    }
  }

  .quire-cover__hero-body {
    padding-top: 1.25rem;
    padding-bottom: 2rem;
    width:100%;

    .container {
      background:none;
      color: $off-black;
      margin: 0 $gap;
      padding: 0 1.5rem;
      position: unset;
      display:block;
      text-align: center;
      width:100%;

      .publication-logo {
        width: 100%;
        margin: 1rem 0 2rem;
        max-width: 48rem;
      }

      // TODO: go into base styles and remove all nested text color declarations
      h1 {
        color: inherit;
        font-size: 1.75rem;
        line-height: 1.4;
        margin: 0 0 .625em;

        .subtitle {
          color: inherit;
          font-size: 1.375rem;
          line-height: 1.45;
          margin-top: .5em;
        }
      }
      .reading-line {
        color: inherit;
      }
      .contributor {
        color: inherit;
        font-family: $typeface-besley; // TODO: make sure this is consistent for contribs, whatever it is
        font-size: 1.25rem;
        font-weight: 600;
        line-height: 1.4;
      }

      @media screen and (min-width: 48rem) {
        margin: 0 auto;
        padding: 0;

        h1 {
          font-size: calc(2rem * #{$quire-cover-text-scale});

          .subtitle {
            font-size: calc(1.5rem * #{$quire-cover-text-scale});
          }
        }
        .contributor {
          font-size: 1.25rem;
        }
      }

    }
  }
}

// TODO: remove the markup from the template if they like this being gone
.quire-cover__more {
  display: none;
}

.quire-cover {
  .quire-page__content {
    .container {
      &.is-fluid {
        .content {
          margin-top: 1em; // TODO: Fix base styles here
          padding-top: 1em !important; // TODO: Fix base styles here, too
        }
      }
    }
  }

  // TODO: consider making this global.
  .quire-contents-buttons {
    padding-top: 0;
  }
}

/* ToC page
 * Also made changes to _includes/components/table-of-contents/item/list.js
 * Original markup needed to change
 * Overly broad * selector commented out in quire-contents-list.scss as well
 ************************************************************************/
.quire-contents {
  .quire-page__content {
    .container {
      max-width:38em;
    }
  }
}

.quire-contents-list {
  &.list {
    font-family: $quire-navigation-font;

    .table-of-contents {
      .table-of-contents-list {
        a {
          .contents-page-title {
            font-size: 1.125em;
            font-weight: 600;
          }
          .contributor {
            color: $content-text-color;
            display: block;
            font-style: normal;
      
            &::before {
              content: "by";
              display: inline-block;
              margin: 0 .25em 0 1em;
            }
          }

          &:hover {
            .contents-page-title {
              text-decoration: underline;
            }
          }
        }
      }
    }
  }
}

/*========================================================================
 * END of Table of Contents page customizations
 */


/*------------------------------------------------------------------------
 * Navbar customizations
 * Removed overly broad * selector in quire-navbar.scss
 -----------------------------------------------------------------------*/
.quire-navbar {
  text-shadow:0 0.08333em 0.16667em rgba(0,0,0,0.3);

  .quire-navbar-controls {
    .quire-navbar-button {
      text-shadow:0 0.08333em 0.16667em rgba(0,0,0,0.3);
      color: inherit;

      &:hover {
        color: $quire-navbar-hover-text-color;
      }
    }
  }
  .quire-navbar-page-controls {
    &__item{
      &.quire-previous-page {
        padding-right: 1rem;
      }
      &.quire-next-page {
        padding-left: 1rem;
        position: relative;

        a {
          &::before {
            color: $white;
            content: '|';
            position: absolute;
            left:-.125rem;
            z-index: 10;
          }
        
          &:hover {
            &::before {
              color: $white;
            }
          }
        }
      }
    }
  }
}

/*========================================================================
 * END of Navbar customizations
 =======================================================================*/

/*------------------------------------------------------------------------
 * Menu customizations
 -----------------------------------------------------------------------*/
.menu {
  font-size: 1.25rem;
  line-height: 1.4;
  text-shadow:0 0.08333em 0.16667em rgba(0,0,0,0.3);

  .quire-menu__header__contributors {
    font-family: $typeface-besley;
    font-size: .75em;
    font-style: normal;
    margin-top: 1em;
  }

  .quire-menu__list {
    .page-item {
      line-height: 1.4;
      
    }
  }
}


/*------------------------------------------------------------------------
 * Page customizations
 -----------------------------------------------------------------------*/
// Quire's misunderstanding of CSS specificity strikes again.
// Consequently, this selector is wildly overdefined now.
// The more time I spend in Quire, the more I want to forcibly strip out
// all of the CSS (especially Bulma) and start over.
.quire-page .quire-page__content .container.is-fluid .content {
  .dam-credit-line {
    font-family: $quire-footnotes-font;
    font-size: 1.125rem;
    line-height: $quire-backmatter-line-height;

    &.page-end {
      margin-top: 2rem;
    }
  }
}
.quire-essay {
  .quire-page {
    &__header {
      &.hero {
        background: $main-red;
        text-shadow:0 0.08333em 0.16667em rgba(0,0,0,0.2);

        .hero-body {
          color: $off-white;

          .quire-page__header__title {
            color: inherit;
            max-width: 54ch;
            margin: 0 auto;
          }

          .quire-page__header__contributor {
            font-size: px-to-rem(24px);
            font-style: normal;
            font-weight: 500;
          }
        }
      }
    }
  }
}

.quire-page__content {
  .container { 
    .content {
      .backmatter {
        font-size: 1.25rem;
        margin-top: 3rem;
        h2 {
          font-size: 1.25em;
          margin: 1.6em 0 1em;
        }
      }
      .footnotes {
        font-size:1.125rem;

        .footnotes-list {
          .footnote-item {
            max-width: 68ch;
          }
        }
      }
    }
  }
}

/*========================================================================
 * END of Page customizations
 =======================================================================*/